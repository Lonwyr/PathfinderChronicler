sap.ui.define(["./BaseController","sap/ui/core/Fragment"],function(t,e){"use strict";function a(t,a,d){if(!this.byId(t)){const n=this.getView();return e.load({id:n.getId(t),name:"com.lonwyr.PathfinderChronicler.fragments."+a,controller:this}).then(t=>{n.addDependent(t);if(d){t.getCustomData()[0].setKey(d)}t.open();return t})}if(d){this.byId(t).getCustomData()[0].setKey(d)}this.byId(t).open();return Promise.resolve(this.byId(t))}function d(t,e){let a=e.getPath().split("/");a.shift();let d=t.getData();a.forEach((t,e)=>{if(e===a.length-1){d.splice(Number.parseInt(t),1)}else{d=d[t]}});t.updateBindings(true)}return t.extend("com.lonwyr.PathfinderChronicler.controller.MaintainPlayers",{onInit:function(){},openAddEvent:function(){a.call(this,"addEvent","AddEvent")},addEvent:function(){const t=this.getModel("data");var e=t.getData();e.events.push({name:this.byId("addEvent_name").getValue(),id:this.byId("addEvent_id").getValue()});t.setData(e);t.updateBindings(true);this.closeAddEvent()},closeAddEvent:function(){this.byId("addEvent").close()},editEvent:function(t){const e=t.getSource().getBindingContext("data");a.call(this,"editEvent","EditEvent").then(t=>{t.setBindingContext(e,"data")})},closeEditEvent:function(){this.byId("editEvent").close()},deleteEvent:function(t){const e=t.getSource().getBindingContext("data");const a=this.getModel("data");d(a,e);this.closeEditEvent()},openAddPlayer:function(){a.call(this,"addPlayer","AddPlayer")},addPlayer:function(t){const e=this.getModel("data");var a=e.getData();a.players.push({name:this.byId("addPlayer_name").getValue(),id:this.byId("addPlayer_id").getValue(),characters:[]});e.setData(a);e.updateBindings(true);this.closeAddPlayer()},closeAddPlayer:function(){this.byId("addPlayer").close()},editPlayer:function(t){const e=t.getSource().getBindingContext("data");a.call(this,"editPlayer","EditPlayer").then(t=>{t.setBindingContext(e,"data")})},closeEditPlayer:function(){this.byId("editPlayer").close()},deletePlayer:function(t){const e=t.getSource().getBindingContext("data");const a=this.getModel("data");d(a,e);this.closeEditPlayer()},openAddCharacter:function(t){const e=t.getSource().getBindingContext("data").getPath();a.call(this,"addCharacter","AddCharacter",e).then(()=>{this.byId("addCharacter_level").setValue("");this.byId("addCharacter_name").setValue("");this.byId("addCharacter_id").setValue("")})},closeAddCharacter:function(){this.byId("addCharacter").close()},addCharacter:function(){const t=this.byId("addCharacter").getCustomData()[0].getKey();const e=Number.parseInt(this.byId("addCharacter_level").getValue());const a={name:this.byId("addCharacter_name").getValue(),id:this.byId("addCharacter_id").getValue(),level:Number.isInteger(e)?e:undefined};const d=this.getModel("data");d.getProperty(t).characters.push(a);d.updateBindings(true);this.closeAddCharacter()},editCharacter:function(t){const e=t.getSource().getBindingContext("data");a.call(this,"editCharacter","EditCharacter").then(t=>{t.setBindingContext(e,"data")})},closeEditCharacter:function(){this.byId("editCharacter").close()},deleteCharacter:function(t){const e=t.getSource().getBindingContext("data");const a=this.getModel("data");d(a,e);this.closeEditCharacter()}})});